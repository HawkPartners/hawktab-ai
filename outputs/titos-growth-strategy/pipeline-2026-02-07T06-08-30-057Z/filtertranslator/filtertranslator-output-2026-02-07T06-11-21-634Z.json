{
  "translation": {
    "filters": [
      {
        "ruleId": "rule_s6a_hispanic_filter",
        "questionId": "S6a",
        "action": "filter",
        "filterExpression": "S6 == 1",
        "baseText": "Those who indicated they are of Hispanic or Latino origin (S6 = 1)",
        "splits": [],
        "alternatives": [
          {
            "expression": "S6 %in% c(1)",
            "confidence": 0.75,
            "reason": "Equivalent to S6 == 1; provided as an alternative form but not materially different."
          }
        ],
        "confidence": 0.95,
        "reasoning": "Datamap contains S6 with values 1=Yes, 2=No. The rule explicitly requires S6 = 1, so the minimal additional constraint is S6 == 1.",
        "humanReviewRequired": false
      },
      {
        "ruleId": "rule_a5_form_of_drink_filter",
        "questionId": "A5",
        "action": "filter",
        "filterExpression": "A4 %in% c(7, 8, 9, 10, 11, 12, 13)",
        "baseText": "Those whose A4 (type of drink) is one of the spirit categories (options 7–13)",
        "splits": [],
        "alternatives": [
          {
            "expression": "A4 >= 7 & A4 <= 13",
            "confidence": 0.75,
            "reason": "Equivalent numeric range if A4 is strictly integers and options are contiguous 7–13; slightly less explicit about exact allowed values."
          }
        ],
        "confidence": 0.95,
        "reasoning": "Datamap contains A4 (categorical_select) with allowed values including 7–15; rule explicitly lists 7,8,9,10,11,12,13 — mapping to A4 %in% c(... ) is direct and minimal.",
        "humanReviewRequired": false
      },
      {
        "ruleId": "rule_a6_on_premise_filter",
        "questionId": "A6",
        "action": "filter",
        "filterExpression": "(hLOCATIONr3 == 1 | hLOCATIONr5 == 1 | hLOCATIONr6 == 1 | hLOCATIONr7 == 1 | hLOCATIONr9 == 1 | hLOCATIONr10 == 1 | hLOCATIONr11 == 1 | hLOCATIONr12 == 1 | hLOCATIONr13 == 1 | hLOCATIONr14 == 1)",
        "baseText": "Those for whom the looped location is an on‑premise location",
        "splits": [],
        "alternatives": [
          {
            "expression": "(dLOCATIONr3 == 1 | dLOCATIONr5 == 1 | dLOCATIONr6 == 1 | dLOCATIONr7 == 1 | dLOCATIONr9 == 1 | dLOCATIONr10 == 1 | dLOCATIONr11 == 1 | dLOCATIONr12 == 1 | dLOCATIONr13 == 1 | dLOCATIONr14 == 1)",
            "confidence": 0.65,
            "reason": "Some hidden/admin variables use dLOCATIONr* to flag assigned location; if the loop uses dLOCATIONr* instead of hLOCATIONr*, that would be the correct flags. Datamap contains both hLOCATIONr* and dLOCATIONr*."
          },
          {
            "expression": "(hLOCATIONr3 == 1 | hLOCATIONr5 == 1 | hLOCATIONr6 == 1 | hLOCATIONr7 == 1 | hLOCATIONr9 == 1 | hLOCATIONr10 == 1 | hLOCATIONr11 == 1 | hLOCATIONr12 == 1 | hLOCATIONr13 == 1 | hLOCATIONr14 == 1) & !is.na(A6)",
            "confidence": 0.4,
            "reason": "Redundant: default pipeline already applies non-NA for target question; included here only if caller wants explicit NA guard (not recommended)."
          }
        ],
        "confidence": 0.8,
        "reasoning": "Datamap includes hLOCATIONr* variables (hLOCATIONr1..hLOCATIONr16) which are hidden flags for the randomly assigned location for the loop. On-premise locations correspond to venue types such as 'At work/office' (hLOCATIONr3), various restaurant/bar/hotel/entertainment flags (r5, r6, r7, r9, r10, r11, r12, r13, r14). The primary expression checks those hLOCATIONr* flags equal 1. This is minimal: it only adds the on-premise constraint on top of the default banner cut + non-NA for A6.",
        "humanReviewRequired": false
      },
      {
        "ruleId": "rule_a10_not_alone_filter",
        "questionId": "A10",
        "action": "filter",
        "filterExpression": "A9r1 != 1",
        "baseText": "Those who were not alone when they had the drink",
        "splits": [],
        "alternatives": [
          {
            "expression": "A9r1 == 0",
            "confidence": 0.75,
            "reason": "If 'I was alone' is coded as 1 in A9r1 (binary_flag: 0/1), then not alone could be represented by 0. Use this only if data encodes presence of the option as 1 and selection as 0 (less likely)."
          },
          {
            "expression": "(A9r1 != 1 | is.na(A9r1))",
            "confidence": 0.6,
            "reason": "Less preferred: includes rows where A9r1 is NA. The default pipeline already filters NA for the target question A10, so adding NA here may be redundant; include only if you want to allow A10 when A9 is missing."
          }
        ],
        "confidence": 0.9,
        "reasoning": "Datamap shows A9r1: 'I was alone' as a binary_flag with allowed values 0/1. The plain text rule requires excluding respondents who selected 'I was alone' (A9 == 1). Minimal additional constraint is A9r1 != 1.",
        "humanReviewRequired": false
      },
      {
        "ruleId": "rule_a13_brand_filter",
        "questionId": "A13",
        "action": "filter",
        "filterExpression": "A4 %in% c(4, 5, 7, 8, 9, 10, 11, 12, 13)",
        "baseText": "Asked only if the drink type (A4) is one of: 4, 5, 7, 8, 9, 10, 11, 12, or 13",
        "splits": [],
        "alternatives": [
          {
            "expression": "A4 %in% c(4,5,7:13)",
            "confidence": 0.85,
            "reason": "Shorthand using R sequence 7:13 is equivalent for integers; minimal difference. Both valid R expressions."
          },
          {
            "expression": "(A4 == 4) | (A4 == 5) | (A4 %in% 7:13)",
            "confidence": 0.7,
            "reason": "Verbose alternative with same semantics; useful if explicit equality checks are preferred."
          }
        ],
        "confidence": 0.95,
        "reasoning": "A4 exists in the datamap as a categorical_select with allowed values including 4,5,7-13. The rule explicitly lists those integer codes, so the minimal filter is A4 in that set.",
        "humanReviewRequired": false
      },
      {
        "ruleId": "rule_a13b_followup_otherdrinks_filter",
        "questionId": "A13b",
        "action": "filter",
        "filterExpression": "A13a_1 == 1",
        "baseText": "Respondents who said they had other drinks in addition to the target drink (A13a = 1)",
        "splits": [],
        "alternatives": [
          {
            "expression": "A13a_1 %in% c(1)",
            "confidence": 0.9,
            "reason": "Equivalent to A13a_1 == 1; explicit %in% form sometimes used for consistency."
          }
        ],
        "confidence": 0.95,
        "reasoning": "Datamap contains A13a_1 (categorical_select 1=Yes, 2=No). The rule explicitly requires A13a = 1 (Yes). Minimal additional constraint is A13a_1 == 1.",
        "humanReviewRequired": false
      },
      {
        "ruleId": "rule_a14a_off_premise_filter",
        "questionId": "A14a",
        "action": "filter",
        "filterExpression": "(hLOCATIONr2 == 0 & hLOCATIONr3 == 0 & hLOCATIONr4 == 0 & hLOCATIONr5 == 0 & hLOCATIONr6 == 0 & hLOCATIONr7 == 0 & hLOCATIONr8 == 0 & hLOCATIONr9 == 0 & hLOCATIONr10 == 0 & hLOCATIONr11 == 0 & hLOCATIONr12 == 0 & hLOCATIONr13 == 0 & hLOCATIONr14 == 0 & hLOCATIONr15 == 0 & hLOCATIONr16 == 0 & hLOCATIONr1 == 0)",
        "baseText": "Respondents whose assigned location for this occasion is an off‑premise location",
        "splits": [],
        "alternatives": [
          {
            "expression": "dLOCATIONr1 == 1 | dLOCATIONr2 == 1 | dLOCATIONr3 == 1 | dLOCATIONr4 == 1 | dLOCATIONr5 == 1 | dLOCATIONr6 == 1 | dLOCATIONr7 == 1 | dLOCATIONr8 == 1 | dLOCATIONr9 == 1 | dLOCATIONr10 == 1 | dLOCATIONr11 == 1 | dLOCATIONr12 == 1 | dLOCATIONr13 == 1 | dLOCATIONr14 == 1 | dLOCATIONr15 == 1 | dLOCATIONr16 == 1",
            "confidence": 0.65,
            "reason": "If the datamap uses dLOCATIONr* (hidden dLOCATION) flags to indicate the actual location chosen for the looped occasion; this alternative checks any off‑premise location flag being set. Use if hLOCATIONr* are not the correct indicators of assignment."
          },
          {
            "expression": "hLOCATIONr8 == 1 | hLOCATIONr9 == 1 | hLOCATIONr10 == 1 | hLOCATIONr11 == 1 | hLOCATIONr12 == 1 | hLOCATIONr13 == 1 | hLOCATIONr14 == 1 | hLOCATIONr15 == 1 | hLOCATIONr16 == 1",
            "confidence": 0.5,
            "reason": "If only a subset of hLOCATIONr* correspond to off‑premise (e.g., bars/restaurants are on‑premise and others off‑premise). The rule text is ambiguous which hLOCATION codes are considered off‑premise; this is a conservative alternative selecting commonly off‑premise location codes. Human review recommended."
          }
        ],
        "confidence": 0.6,
        "reasoning": "Datamap contains many hidden location flags: hLOCATIONr1..hLOCATIONr16 and dLOCATIONr1..dLOCATIONr16. The rule requires 'off‑premise' assigned location. There is no explicit variable named 'off_premise'. Primary expression assumes off‑premise means none of the hLOCATIONr* left-side (which may indicate on‑premise) are set — however this is an inferred interpretation and may over/under filter. Alternatives provided. Human review recommended to confirm which hLOCATIONr/dLOCATIONr codes represent off‑premise.",
        "humanReviewRequired": true
      },
      {
        "ruleId": "rule_a14a_off_premise_filter",
        "questionId": "A14b",
        "action": "filter",
        "filterExpression": "(hLOCATIONr2 == 0 & hLOCATIONr3 == 0 & hLOCATIONr4 == 0 & hLOCATIONr5 == 0 & hLOCATIONr6 == 0 & hLOCATIONr7 == 0 & hLOCATIONr8 == 0 & hLOCATIONr9 == 0 & hLOCATIONr10 == 0 & hLOCATIONr11 == 0 & hLOCATIONr12 == 0 & hLOCATIONr13 == 0 & hLOCATIONr14 == 0 & hLOCATIONr15 == 0 & hLOCATIONr16 == 0 & hLOCATIONr1 == 0)",
        "baseText": "Respondents whose assigned location for this occasion is an off‑premise location",
        "splits": [],
        "alternatives": [
          {
            "expression": "dLOCATIONr1 == 1 | dLOCATIONr2 == 1 | dLOCATIONr3 == 1 | dLOCATIONr4 == 1 | dLOCATIONr5 == 1 | dLOCATIONr6 == 1 | dLOCATIONr7 == 1 | dLOCATIONr8 == 1 | dLOCATIONr9 == 1 | dLOCATIONr10 == 1 | dLOCATIONr11 == 1 | dLOCATIONr12 == 1 | dLOCATIONr13 == 1 | dLOCATIONr14 == 1 | dLOCATIONr15 == 1 | dLOCATIONr16 == 1",
            "confidence": 0.65,
            "reason": "Alternative using dLOCATIONr* hidden flags if those indicate the selected location for the looped occasion."
          }
        ],
        "confidence": 0.6,
        "reasoning": "Same rationale as for A14a. Need confirmation which hidden location variables indicate off‑premise assignment.",
        "humanReviewRequired": true
      },
      {
        "ruleId": "rule_a14a_off_premise_filter",
        "questionId": "A15",
        "action": "filter",
        "filterExpression": "(hLOCATIONr2 == 0 & hLOCATIONr3 == 0 & hLOCATIONr4 == 0 & hLOCATIONr5 == 0 & hLOCATIONr6 == 0 & hLOCATIONr7 == 0 & hLOCATIONr8 == 0 & hLOCATIONr9 == 0 & hLOCATIONr10 == 0 & hLOCATIONr11 == 0 & hLOCATIONr12 == 0 & hLOCATIONr13 == 0 & hLOCATIONr14 == 0 & hLOCATIONr15 == 0 & hLOCATIONr16 == 0 & hLOCATIONr1 == 0)",
        "baseText": "Respondents whose assigned location for this occasion is an off‑premise location",
        "splits": [],
        "alternatives": [
          {
            "expression": "dLOCATIONr1 == 1 | dLOCATIONr2 == 1 | dLOCATIONr3 == 1 | dLOCATIONr4 == 1 | dLOCATIONr5 == 1 | dLOCATIONr6 == 1 | dLOCATIONr7 == 1 | dLOCATIONr8 == 1 | dLOCATIONr9 == 1 | dLOCATIONr10 == 1 | dLOCATIONr11 == 1 | dLOCATIONr12 == 1 | dLOCATIONr13 == 1 | dLOCATIONr14 == 1 | dLOCATIONr15 == 1 | dLOCATIONr16 == 1",
            "confidence": 0.65,
            "reason": "Alternative using dLOCATIONr* flags."
          }
        ],
        "confidence": 0.6,
        "reasoning": "Same as above.",
        "humanReviewRequired": true
      },
      {
        "ruleId": "rule_a14a_off_premise_filter",
        "questionId": "A16",
        "action": "filter",
        "filterExpression": "(hLOCATIONr2 == 0 & hLOCATIONr3 == 0 & hLOCATIONr4 == 0 & hLOCATIONr5 == 0 & hLOCATIONr6 == 0 & hLOCATIONr7 == 0 & hLOCATIONr8 == 0 & hLOCATIONr9 == 0 & hLOCATIONr10 == 0 & hLOCATIONr11 == 0 & hLOCATIONr12 == 0 & hLOCATIONr13 == 0 & hLOCATIONr14 == 0 & hLOCATIONr15 == 0 & hLOCATIONr16 == 0 & hLOCATIONr1 == 0)",
        "baseText": "Respondents whose assigned location for this occasion is an off‑premise location",
        "splits": [],
        "alternatives": [
          {
            "expression": "dLOCATIONr1 == 1 | dLOCATIONr2 == 1 | dLOCATIONr3 == 1 | dLOCATIONr4 == 1 | dLOCATIONr5 == 1 | dLOCATIONr6 == 1 | dLOCATIONr7 == 1 | dLOCATIONr8 == 1 | dLOCATIONr9 == 1 | dLOCATIONr10 == 1 | dLOCATIONr11 == 1 | dLOCATIONr12 == 1 | dLOCATIONr13 == 1 | dLOCATIONr14 == 1 | dLOCATIONr15 == 1 | dLOCATIONr16 == 1",
            "confidence": 0.65,
            "reason": "Alternative using dLOCATIONr* flags."
          }
        ],
        "confidence": 0.6,
        "reasoning": "Same as above.",
        "humanReviewRequired": true
      },
      {
        "ruleId": "rule_a14a_off_premise_filter",
        "questionId": "A17",
        "action": "filter",
        "filterExpression": "(hLOCATIONr2 == 0 & hLOCATIONr3 == 0 & hLOCATIONr4 == 0 & hLOCATIONr5 == 0 & hLOCATIONr6 == 0 & hLOCATIONr7 == 0 & hLOCATIONr8 == 0 & hLOCATIONr9 == 0 & hLOCATIONr10 == 0 & hLOCATIONr11 == 0 & hLOCATIONr12 == 0 & hLOCATIONr13 == 0 & hLOCATIONr14 == 0 & hLOCATIONr15 == 0 & hLOCATIONr16 == 0 & hLOCATIONr1 == 0)",
        "baseText": "Respondents whose assigned location for this occasion is an off‑premise location",
        "splits": [],
        "alternatives": [
          {
            "expression": "dLOCATIONr1 == 1 | dLOCATIONr2 == 1 | dLOCATIONr3 == 1 | dLOCATIONr4 == 1 | dLOCATIONr5 == 1 | dLOCATIONr6 == 1 | dLOCATIONr7 == 1 | dLOCATIONr8 == 1 | dLOCATIONr9 == 1 | dLOCATIONr10 == 1 | dLOCATIONr11 == 1 | dLOCATIONr12 == 1 | dLOCATIONr13 == 1 | dLOCATIONr14 == 1 | dLOCATIONr15 == 1 | dLOCATIONr16 == 1",
            "confidence": 0.65,
            "reason": "Alternative using dLOCATIONr* flags."
          }
        ],
        "confidence": 0.6,
        "reasoning": "Same as above.",
        "humanReviewRequired": true
      },
      {
        "ruleId": "rule_a14a_off_premise_filter",
        "questionId": "A18",
        "action": "filter",
        "filterExpression": "(hLOCATIONr2 == 0 & hLOCATIONr3 == 0 & hLOCATIONr4 == 0 & hLOCATIONr5 == 0 & hLOCATIONr6 == 0 & hLOCATIONr7 == 0 & hLOCATIONr8 == 0 & hLOCATIONr9 == 0 & hLOCATIONr10 == 0 & hLOCATIONr11 == 0 & hLOCATIONr12 == 0 & hLOCATIONr13 == 0 & hLOCATIONr14 == 0 & hLOCATIONr15 == 0 & hLOCATIONr16 == 0 & hLOCATIONr1 == 0)",
        "baseText": "Respondents whose assigned location for this occasion is an off‑premise location",
        "splits": [],
        "alternatives": [
          {
            "expression": "dLOCATIONr1 == 1 | dLOCATIONr2 == 1 | dLOCATIONr3 == 1 | dLOCATIONr4 == 1 | dLOCATIONr5 == 1 | dLOCATIONr6 == 1 | dLOCATIONr7 == 1 | dLOCATIONr8 == 1 | dLOCATIONr9 == 1 | dLOCATIONr10 == 1 | dLOCATIONr11 == 1 | dLOCATIONr12 == 1 | dLOCATIONr13 == 1 | dLOCATIONr14 == 1 | dLOCATIONr15 == 1 | dLOCATIONr16 == 1",
            "confidence": 0.65,
            "reason": "Alternative using dLOCATIONr* flags."
          }
        ],
        "confidence": 0.6,
        "reasoning": "Same as above.",
        "humanReviewRequired": true
      },
      {
        "ruleId": "rule_a14a_off_premise_filter",
        "questionId": "A19",
        "action": "filter",
        "filterExpression": "(hLOCATIONr2 == 0 & hLOCATIONr3 == 0 & hLOCATIONr4 == 0 & hLOCATIONr5 == 0 & hLOCATIONr6 == 0 & hLOCATIONr7 == 0 & hLOCATIONr8 == 0 & hLOCATIONr9 == 0 & hLOCATIONr10 == 0 & hLOCATIONr11 == 0 & hLOCATIONr12 == 0 & hLOCATIONr13 == 0 & hLOCATIONr14 == 0 & hLOCATIONr15 == 0 & hLOCATIONr16 == 0 & hLOCATIONr1 == 0)",
        "baseText": "Respondents whose assigned location for this occasion is an off‑premise location",
        "splits": [],
        "alternatives": [
          {
            "expression": "dLOCATIONr1 == 1 | dLOCATIONr2 == 1 | dLOCATIONr3 == 1 | dLOCATIONr4 == 1 | dLOCATIONr5 == 1 | dLOCATIONr6 == 1 | dLOCATIONr7 == 1 | dLOCATIONr8 == 1 | dLOCATIONr9 == 1 | dLOCATIONr10 == 1 | dLOCATIONr11 == 1 | dLOCATIONr12 == 1 | dLOCATIONr13 == 1 | dLOCATIONr14 == 1 | dLOCATIONr15 == 1 | dLOCATIONr16 == 1",
            "confidence": 0.65,
            "reason": "Alternative using dLOCATIONr* flags."
          }
        ],
        "confidence": 0.6,
        "reasoning": "Same as above.",
        "humanReviewRequired": true
      },
      {
        "ruleId": "rule_a14b_if_purchased_filter",
        "questionId": "A14b",
        "action": "filter",
        "filterExpression": "A14a_1 == 1 | A14a_2 == 1 | A14a_1 == 1",
        "baseText": "Those who indicated they went to the store / made the purchase themselves (A14a = 1)",
        "splits": [],
        "alternatives": [
          {
            "expression": "A14a_1 == 1",
            "confidence": 0.85,
            "reason": "If A14b refers specifically to the first purchase question (A14b_1), filter by A14a_1 == 1. Datamap contains A14a_1 and A14a_2 (for two locations)."
          },
          {
            "expression": "A14a_2 == 1",
            "confidence": 0.85,
            "reason": "If A14b refers specifically to the second purchase question (A14b_2), filter by A14a_2 == 1."
          },
          {
            "expression": "(A14a_1 == 1 | A14a_2 == 1)",
            "confidence": 0.65,
            "reason": "If reporting A14b aggregated across both location versions, include respondents who answered '1' to either A14a_1 or A14a_2. This is broader and may be appropriate if A14b is shown for either location."
          }
        ],
        "confidence": 0.7,
        "reasoning": "Datamap contains A14a_1 and A14a_2 (values 1=I went to the store/made the purchase myself). The rule references A14a = 1; since the survey has separate A14a variables for Location1 and Location2, the minimal safe filter depends on which A14b instance this A14b refers to. If A14b is per-location (A14b_1 or A14b_2) use the matching A14a variable (A14a_1 or A14a_2). If A14b is an aggregated field, include respondents with either A14a_1 or A14a_2 == 1.",
        "humanReviewRequired": true
      },
      {
        "ruleId": "rule_a15_vodka_size_filter",
        "questionId": "A15",
        "action": "filter",
        "filterExpression": "A4 == 7 & A14a_1 == 1",
        "baseText": "Respondents who had Vodka (A4 = 7) and who purchased it themselves (A14a = 1) — for Location 1",
        "splits": [],
        "alternatives": [
          {
            "expression": "A4 == 7 & A14a_2 == 1",
            "confidence": 0.7,
            "reason": "If A15 is intended to apply to the Location 2 version of the question set (A4_2 / A14a_2) rather than Location 1. Datamap contains A14a_1 and A14a_2 and A4 and A4_2; the rule text references 'LOCATION 1/LOCATION 2' which is ambiguous."
          },
          {
            "expression": "(A4 == 7 & A14a_1 == 1) | (A4_2 == 7 & A14a_2 == 1)",
            "confidence": 0.6,
            "reason": "Covers both location blocks (Location1 and Location2). Use if A15 in dataset is populated for either location's Vodka purchase. This is broader and may over-include if A15 specifically belongs to Location 1 only."
          }
        ],
        "confidence": 0.85,
        "reasoning": "Datamap includes A4 (type for the primary drink) with value 7 = Vodka, and A14a_1 (role in purchase for Location 1) with values 1-4 where 1 = 'I went to the store/made the purchase myself'. A15 exists as the vodka size question. Primary minimal filter assumes Location 1 variables (A4 and A14a_1).",
        "humanReviewRequired": false
      },
      {
        "ruleId": "rule_a16_a17_a18_a19_purchase_followups_filter",
        "questionId": "A16",
        "action": "filter",
        "filterExpression": "A14a_1 == 1",
        "baseText": "Those who indicated they purchased the drink themselves (A14a = 1)",
        "splits": [],
        "alternatives": [
          {
            "expression": "A14a_2 == 1",
            "confidence": 0.45,
            "reason": "If this table were meant to apply to the second drink/location instead of the first. Datamap contains A14a_1 and A14a_2; rule text references 'A14a' generically. Use only if reporting for the second location."
          }
        ],
        "confidence": 0.9,
        "reasoning": "Datamap contains A14a_1 (response options 1=Yes, 2=No). The rule states A14a = 1 (purchased themselves). Minimal constraint is A14a_1 == 1 applied on top of the default base.",
        "humanReviewRequired": false
      },
      {
        "ruleId": "rule_a16_a17_a18_a19_purchase_followups_filter",
        "questionId": "A17",
        "action": "filter",
        "filterExpression": "A14a_1 == 1",
        "baseText": "Those who indicated they purchased the drink themselves (A14a = 1)",
        "splits": [],
        "alternatives": [
          {
            "expression": "A14a_2 == 1",
            "confidence": 0.45,
            "reason": "If this table/question refers to the second drink/location. Datamap contains A14a_1 and A14a_2; rule text uses generic A14a."
          }
        ],
        "confidence": 0.9,
        "reasoning": "A17 should be shown only to respondents who purchased the drink themselves. Use A14a_1 == 1 (first location) per datamap. Minimal additional constraint avoids over-filtering.",
        "humanReviewRequired": false
      },
      {
        "ruleId": "rule_a16_a17_a18_a19_purchase_followups_filter",
        "questionId": "A18",
        "action": "filter",
        "filterExpression": "A14a_1 == 1",
        "baseText": "Those who indicated they purchased the drink themselves (A14a = 1)",
        "splits": [],
        "alternatives": [
          {
            "expression": "A14a_2 == 1",
            "confidence": 0.45,
            "reason": "If this question pertains to the second drink/location (A14a_2)."
          }
        ],
        "confidence": 0.9,
        "reasoning": "Datamap has A14a_1; rule requires A14a = 1. Apply A14a_1 == 1 as the minimal filter.",
        "humanReviewRequired": false
      },
      {
        "ruleId": "rule_a16_a17_a18_a19_purchase_followups_filter",
        "questionId": "A19",
        "action": "filter",
        "filterExpression": "A14a_1 == 1",
        "baseText": "Those who indicated they purchased the drink themselves (A14a = 1)",
        "splits": [],
        "alternatives": [
          {
            "expression": "A14a_2 == 1",
            "confidence": 0.45,
            "reason": "If A19 refers to the second drink/location, A14a_2 == 1 would be the corresponding filter."
          }
        ],
        "confidence": 0.9,
        "reasoning": "A19 should only be asked of respondents who purchased the drink themselves. Datamap provides A14a_1 (and A14a_2 for location 2). Primary minimal filter uses A14a_1 == 1.",
        "humanReviewRequired": false
      },
      {
        "ruleId": "rule_a22_brand_attribute_filter",
        "questionId": "A22",
        "action": "filter",
        "filterExpression": "(A21r1 == 1 | A21r2 == 1 | A21r3 == 1 | A21r4 == 1 | A21r5 == 1 | A21r6 == 1)",
        "baseText": "Respondents who selected at least one brand in A21",
        "splits": [],
        "alternatives": [
          {
            "expression": "(A21r1 + A21r2 + A21r3 + A21r4 + A21r5 + A21r6) > 0",
            "confidence": 0.85,
            "reason": "Equivalent numeric-sum check across the six brand flags (works because these are binary 0/1). Slightly less explicit but concise."
          },
          {
            "expression": "A21r7 != 1",
            "confidence": 0.4,
            "reason": "Treat 'None of the above' (A21r7) as exclusive: if not selected then assume at least one brand chosen. This is risky because A21r7 could be unselected while no brand flags are set (e.g., missing), so lower confidence."
          }
        ],
        "confidence": 0.95,
        "reasoning": "Datamap contains A21r1..A21r7 as binary_flag variables. The rule requires at least one brand selected: the minimal, explicit translation is to require any of the brand flags (A21r1..A21r6) equal 1. A21r7 is 'None of the above' and therefore not included in the positive check. This expression is minimal and avoids over-filtering.",
        "humanReviewRequired": false
      },
      {
        "ruleId": "rule_a23_show_selected_brands_rowlevel",
        "questionId": "A23",
        "action": "split",
        "filterExpression": "",
        "baseText": "Show each A23 brand row only for respondents who selected that brand in A21",
        "splits": [
          {
            "rowVariables": [
              "A23r1"
            ],
            "filterExpression": "A21r1 == 1",
            "baseText": "Respondents who selected Tito's Handmade Vodka in A21",
            "splitLabel": "Tito's Handmade Vodka"
          },
          {
            "rowVariables": [
              "A23r2"
            ],
            "filterExpression": "A21r2 == 1",
            "baseText": "Respondents who selected Grey Goose in A21",
            "splitLabel": "Grey Goose"
          },
          {
            "rowVariables": [
              "A23r3"
            ],
            "filterExpression": "A21r3 == 1",
            "baseText": "Respondents who selected Ketel One in A21",
            "splitLabel": "Ketel One"
          },
          {
            "rowVariables": [
              "A23r4"
            ],
            "filterExpression": "A21r4 == 1",
            "baseText": "Respondents who selected Maker's Mark in A21",
            "splitLabel": "Maker's Mark"
          },
          {
            "rowVariables": [
              "A23r5"
            ],
            "filterExpression": "A21r5 == 1",
            "baseText": "Respondents who selected Casamigos in A21",
            "splitLabel": "Casamigos"
          },
          {
            "rowVariables": [
              "A23r6"
            ],
            "filterExpression": "A21r6 == 1",
            "baseText": "Respondents who selected Don Julio in A21",
            "splitLabel": "Don Julio"
          }
        ],
        "alternatives": [
          {
            "expression": "A21r1 == 1",
            "confidence": 0.95,
            "reason": "Primary mapping: A23r1 corresponds to Tito's and A21r1 exists as binary_flag (0/1). Using == 1 is minimal and exact."
          },
          {
            "expression": "A21r1 %in% c(1)",
            "confidence": 0.6,
            "reason": "Equivalent but more verbose; included for completeness."
          }
        ],
        "confidence": 0.9,
        "reasoning": "Datamap contains A23r1..A23r6 and A21r1..A21r6. Each A23 row maps directly to the corresponding A21 binary_flag variable. Using condition A21rX == 1 is the minimal additional constraint to show the row only when the respondent selected that brand in A21. All referenced variables exist in the datamap.",
        "humanReviewRequired": false
      }
    ]
  },
  "metadata": {
    "filtersTranslated": 21,
    "highConfidenceCount": 13,
    "reviewRequiredCount": 8,
    "durationMs": 130449
  },
  "processingInfo": {
    "timestamp": "2026-02-07T06:11:21.634Z",
    "aiProvider": "azure-openai",
    "model": "azure/gpt-5-mini",
    "reasoningEffort": "minimal"
  }
}