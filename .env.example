# ══════════════════════════════════════════════
# Crosstab AI — Environment Variables
# ══════════════════════════════════════════════
# Copy this file to .env.local for development.
# For Railway production: set these in the Railway dashboard.
#
# Legend:
#   [REQUIRED]  — App will not start without this
#   [REQUIRED*] — Required in production, optional in dev (has dev fallback)
#   [OPTIONAL]  — Has sensible default

# ──────────────────────────────────────────────
# Azure OpenAI [REQUIRED]
# ──────────────────────────────────────────────
# Get these from Azure Portal > Your OpenAI Resource
AZURE_API_KEY=
AZURE_RESOURCE_NAME=
AZURE_API_VERSION=2025-01-01-preview

# ──────────────────────────────────────────────
# Convex — Real-time database [REQUIRED]
# ──────────────────────────────────────────────
# Development: run `npx convex dev` to create project + deployment
# Production: create a separate deployment in Convex Dashboard
# Dashboard: https://dashboard.convex.dev
CONVEX_URL=
NEXT_PUBLIC_CONVEX_URL=
# Deploy key for server-side internalMutation access (all mutations require this)
# Get from: Convex Dashboard → Settings → Deploy Keys
CONVEX_DEPLOY_KEY=

# ──────────────────────────────────────────────
# Cloudflare R2 — File storage [REQUIRED]
# ──────────────────────────────────────────────
# Create bucket in Cloudflare Dashboard > R2 > Create Bucket
# Create API token with Object Read & Write permission
R2_ACCOUNT_ID=
R2_ACCESS_KEY_ID=
R2_SECRET_ACCESS_KEY=
R2_BUCKET_NAME=crosstab-dev

# ──────────────────────────────────────────────
# WorkOS — Authentication [REQUIRED*]
# ──────────────────────────────────────────────
# Create account at https://workos.com
# In production: set redirect URI to your production domain
WORKOS_CLIENT_ID=
WORKOS_API_KEY=
# Generate with: openssl rand -base64 32
WORKOS_COOKIE_PASSWORD=
# Development: http://localhost:3000/auth/callback
# Production: https://your-domain.com/auth/callback
NEXT_PUBLIC_WORKOS_REDIRECT_URI=http://localhost:3000/auth/callback

# Auth Bypass — DEVELOPMENT ONLY
# Set to 'true' to skip WorkOS login (uses hardcoded dev user)
# WARNING: Throws an error if enabled with NODE_ENV=production
AUTH_BYPASS=true

# ──────────────────────────────────────────────
# Sentry — Error tracking [REQUIRED*]
# ──────────────────────────────────────────────
# DSN from Sentry project settings
SENTRY_DSN=
NEXT_PUBLIC_SENTRY_DSN=
# Auth token for source map upload during build (CI/CD only)
# SENTRY_AUTH_TOKEN=

# ──────────────────────────────────────────────
# Model Configuration [OPTIONAL]
# ──────────────────────────────────────────────
# Azure deployment names (not OpenAI model names).
# All have sensible defaults — only override if you need a different model.

# CrosstabAgent: R syntax generation (requires reasoning)
# CROSSTAB_MODEL=o4-mini
# CROSSTAB_MODEL_TOKENS=100000
# CROSSTAB_REASONING_EFFORT=medium

# BannerAgent: Vision/extraction
# BANNER_MODEL=gpt-5-nano
# BANNER_MODEL_TOKENS=128000
# BANNER_REASONING_EFFORT=medium

# VerificationAgent: Table enhancement
# VERIFICATION_MODEL=gpt-5-mini
# VERIFICATION_MODEL_TOKENS=128000
# VERIFICATION_REASONING_EFFORT=medium

# BannerGenerateAgent: AI-generated banner plans
# BANNER_GENERATE_MODEL=gpt-5-mini
# BANNER_GENERATE_MODEL_TOKENS=128000
# BANNER_GENERATE_REASONING_EFFORT=high

# SkipLogicAgent: Survey logic extraction
# SKIPLOGIC_MODEL=gpt-5-mini
# SKIPLOGIC_MODEL_TOKENS=128000
# SKIPLOGIC_REASONING_EFFORT=medium

# FilterTranslatorAgent: Rule-to-R translation
# FILTERTRANSLATOR_MODEL=o4-mini
# FILTERTRANSLATOR_MODEL_TOKENS=100000
# FILTERTRANSLATOR_REASONING_EFFORT=medium

# LoopSemanticsPolicyAgent: Loop classification
# LOOP_SEMANTICS_MODEL=gpt-5-mini
# LOOP_SEMANTICS_MODEL_TOKENS=128000
# LOOP_SEMANTICS_REASONING_EFFORT=medium

# Prompt versions (per-agent) — 'production' or 'alternative'
# CROSSTAB_PROMPT_VERSION=production
# BANNER_PROMPT_VERSION=production
# VERIFICATION_PROMPT_VERSION=production
# SKIPLOGIC_PROMPT_VERSION=production
# FILTERTRANSLATOR_PROMPT_VERSION=production
# LOOP_SEMANTICS_PROMPT_VERSION=production
# BANNER_GENERATE_PROMPT_VERSION=production

# Legacy model aliases (deprecated — use per-agent vars above)
# REASONING_MODEL=o4-mini
# BASE_MODEL=gpt-5-nano

# ──────────────────────────────────────────────
# Pipeline Settings [OPTIONAL]
# ──────────────────────────────────────────────
# MAX_DATA_MAP_VARIABLES=1000
# MAX_BANNER_COLUMNS=100
# TRACING_ENABLED=true
# DATAMAP_FORMAT=raw

# ──────────────────────────────────────────────
# Application [OPTIONAL]
# ──────────────────────────────────────────────
# NODE_ENV=development
# EXPOSE_API_ERROR_DETAILS=false

# ──────────────────────────────────────────────
# Decipher API (not yet in production use)
# ──────────────────────────────────────────────
# DECIPHER_API_KEY=
# DECIPHER_BASE_URL=https://selfserve.decipherinc.com
# DECIPHER_SURVEY_PATH=
