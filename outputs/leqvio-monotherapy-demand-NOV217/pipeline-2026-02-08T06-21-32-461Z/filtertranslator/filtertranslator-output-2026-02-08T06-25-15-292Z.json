{
  "translation": {
    "filters": [
      {
        "ruleId": "rule_s3a_cardio_only",
        "questionId": "S3a",
        "action": "filter",
        "filterExpression": "S2 == 1",
        "baseText": "Respondents who selected 'Cardiologist' at S2",
        "splits": [],
        "alternatives": [
          {
            "expression": "S2 %in% c(1)",
            "confidence": 0.8,
            "reason": "Equivalent set-form expression; no practical difference for a single value but provided as an alternate syntax."
          }
        ],
        "confidence": 0.95,
        "reasoning": "Datamap includes S2 with value 1 labelled 'Cardiologist'. The rule explicitly requires S2 = 1, so the minimal additional constraint is S2 == 1. The pipeline already applies banner cut and non-NA for S3a, so no further conditions are needed.",
        "humanReviewRequired": false
      },
      {
        "ruleId": "rule_s2a_np_pa_office_type",
        "questionId": "S2a",
        "action": "filter",
        "filterExpression": "S2 %in% c(6, 7)",
        "baseText": "Respondents who selected Nurse Practitioner (S2 = 6) or Physician’s Assistant (S2 = 7)",
        "splits": [],
        "alternatives": [
          {
            "expression": "S2 == 6 | S2 == 7",
            "confidence": 0.9,
            "reason": "Equivalent logical form using explicit OR instead of %in%."
          }
        ],
        "confidence": 0.95,
        "reasoning": "Variable S2 exists in the datamap and its value labels show 6 = Nurse Practitioner and 7 = Physician’s Assistant. The rule explicitly requires S2 = 6 or 7, so S2 %in% c(6, 7) is a minimal, exact translation.",
        "humanReviewRequired": false
      },
      {
        "ruleId": "rule_s4_specialty_filter",
        "questionId": "S4",
        "action": "filter",
        "filterExpression": "S2 %in% c(1, 2, 3, 4, 5)",
        "baseText": "Respondents whose primary specialty (S2) is one of: Cardiologist (1), Internal Medicine/GP/Primary Care (2), Nephrologist (3), Endocrinologist (4), or Lipidologist (5).",
        "splits": [],
        "alternatives": [
          {
            "expression": "S2 %in% 1:5",
            "confidence": 0.8,
            "reason": "Equivalent numeric range shorthand; clear if S2 uses contiguous codes 1-5."
          },
          {
            "expression": "S2 >= 1 & S2 <= 5",
            "confidence": 0.6,
            "reason": "Catches any numeric values 1 through 5 but is less explicit about allowed discrete codes; slightly riskier if codes are non-contiguous or if other codes in 1-5 have different meanings in future."
          }
        ],
        "confidence": 0.95,
        "reasoning": "Datamap contains S2 with explicit values 1=Cardiologist, 2=Internal Medicine/GP/Primary Care, 3=Nephrologist, 4=Endocrinologist, 5=Lipidologist. The rule requires S2 in {1,2,3,4,5}; the minimal additional constraint is S2 %in% c(1,2,3,4,5). No translationContext ambiguity and variable exists in the datamap.",
        "humanReviewRequired": false
      },
      {
        "ruleId": "rule_b5_if_internal_med",
        "questionId": "B5",
        "action": "filter",
        "filterExpression": "S2 == 2",
        "baseText": "Respondents who selected Internal Medicine / General Practitioner / Primary Care / Family Practice at S2",
        "splits": [],
        "alternatives": [
          {
            "expression": "S2 %in% c(2)",
            "confidence": 0.6,
            "reason": "Equivalent form using %in%; no change in intent but offered as alternative syntax."
          }
        ],
        "confidence": 0.95,
        "reasoning": "Datamap contains S2 with value 2 = 'Internal Medicine / General Practitioner / Primary Care / Family Practice'. Minimal additional constraint is S2 == 2 to show the B5 question block (B5 rows are recorded as B5r1..B5r5 in the datamap). Default pipeline already removes NAs for the target question, so no further constraint is needed.",
        "humanReviewRequired": false
      },
      {
        "ruleId": "rule_a3a_show_rows_where_a3_gt_0",
        "questionId": "A3a",
        "action": "split",
        "filterExpression": "",
        "baseText": "Show each A3a therapy row only for respondents who reported prescribing that therapy to > 0 of their LAST 100 patients in A3.",
        "splits": [
          {
            "rowVariables": [
              "A3ar1c1",
              "A3ar1c2"
            ],
            "filterExpression": "A3r2 > 0",
            "baseText": "Respondents who prescribed Leqvio (inclisiran) to more than 0 of their last 100 patients",
            "splitLabel": "Leqvio (inclisiran)"
          },
          {
            "rowVariables": [
              "A3ar2c1",
              "A3ar2c2"
            ],
            "filterExpression": "A3r3 > 0",
            "baseText": "Respondents who prescribed Praluent (alirocumab) to more than 0 of their last 100 patients",
            "splitLabel": "Praluent (alirocumab)"
          },
          {
            "rowVariables": [
              "A3ar3c1",
              "A3ar3c2"
            ],
            "filterExpression": "A3r4 > 0",
            "baseText": "Respondents who prescribed Repatha (evolocumab) to more than 0 of their last 100 patients",
            "splitLabel": "Repatha (evolocumab)"
          },
          {
            "rowVariables": [
              "A3ar4c1",
              "A3ar4c2"
            ],
            "filterExpression": "A3r5 > 0",
            "baseText": "Respondents who prescribed Zetia (ezetimibe) to more than 0 of their last 100 patients",
            "splitLabel": "Zetia (ezetimibe)"
          },
          {
            "rowVariables": [
              "A3ar5c1",
              "A3ar5c2"
            ],
            "filterExpression": "A3r6 > 0",
            "baseText": "Respondents who prescribed Nexletol/Nexlizet (bempedoic acid or combination) to more than 0 of their last 100 patients",
            "splitLabel": "Nexletol / Nexlizet"
          }
        ],
        "alternatives": [
          {
            "expression": "A3r2 >= 1 & A3r3 >= 1 & A3r4 >= 1 & A3r5 >= 1 & A3r6 >= 1",
            "confidence": 0.8,
            "reason": "Integer counts: using >= 1 is equivalent to > 0. Provided as an alternative if codebase prefers >= semantics."
          }
        ],
        "confidence": 0.9,
        "reasoning": "Datamap includes A3r1..A3r7 (counts for LAST 100 patients) and A3ar1c1..A3ar5c2 (A3a percent columns). translationContext specifies A3a rows correspond to therapies 2–6 in A3. Mapping: A3ar1* → A3r2 (Leqvio), A3ar2* → A3r3 (Praluent), A3ar3* → A3r4 (Repatha), A3ar4* → A3r5 (Zetia), A3ar5* → A3r6 (Nexletol). For each therapy, the minimal additional constraint is that the corresponding A3r# > 0. All referenced variables exist in the datamap. Human review is not required.",
        "humanReviewRequired": false
      },
      {
        "ruleId": "rule_a3b_show_rows_where_a3a_colb_gt_0",
        "questionId": "A3b",
        "action": "split",
        "filterExpression": "",
        "baseText": "Within A3b, show each therapy row only when the corresponding A3a 'Without a statin' (column B) percentage > 0.",
        "splits": [
          {
            "rowVariables": [
              "A3br1c1",
              "A3br1c2"
            ],
            "filterExpression": "A3ar1c2 > 0",
            "baseText": "Show Leqvio (inclisiran) row when A3a (Leqvio) 'Without a statin' > 0",
            "splitLabel": "Leqvio (inclisiran)"
          },
          {
            "rowVariables": [
              "A3br2c1",
              "A3br2c2"
            ],
            "filterExpression": "A3ar2c2 > 0",
            "baseText": "Show Praluent (alirocumab) row when A3a (Praluent) 'Without a statin' > 0",
            "splitLabel": "Praluent (alirocumab)"
          },
          {
            "rowVariables": [
              "A3br3c1",
              "A3br3c2"
            ],
            "filterExpression": "A3ar3c2 > 0",
            "baseText": "Show Repatha (evolocumab) row when A3a (Repatha) 'Without a statin' > 0",
            "splitLabel": "Repatha (evolocumab)"
          },
          {
            "rowVariables": [
              "A3br4c1",
              "A3br4c2"
            ],
            "filterExpression": "A3ar4c2 > 0",
            "baseText": "Show Zetia (ezetimibe) row when A3a (Zetia) 'Without a statin' > 0",
            "splitLabel": "Zetia (ezetimibe)"
          },
          {
            "rowVariables": [
              "A3br5c1",
              "A3br5c2"
            ],
            "filterExpression": "A3ar5c2 > 0",
            "baseText": "Show Nexletol (bempedoic acid) row when A3a (Nexletol) 'Without a statin' > 0",
            "splitLabel": "Nexletol (bempedoic acid)"
          }
        ],
        "alternatives": [
          {
            "expression": "A3ar1c2 >= 1",
            "confidence": 0.8,
            "reason": "For integer percentage fields, >= 1 is equivalent to > 0; some teams prefer >= 1 to avoid floating/rounding concerns."
          },
          {
            "expression": "A3ar1c2 != 0",
            "confidence": 0.65,
            "reason": "If responses could be negative or nonstandard, != 0 would include any non-zero value; less precise for the intended '> 0' meaning."
          }
        ],
        "confidence": 0.9,
        "reasoning": "Datamap contains A3ar#c2 variables which are the A3a 'Without a statin' (column B) percentages (A3ar1c2 .. A3ar5c2) and A3br#c# variables for A3b rows (A3br1c1/A3br1c2 .. A3br5c1/A3br5c2). The translation maps each A3b therapy row to its corresponding A3a column-B variable and uses > 0 as the minimal constraint to show the row. Mapping and variable existence confirmed in datamap.",
        "humanReviewRequired": false
      },
      {
        "ruleId": "rule_a4a_show_rows_where_a4_gt_0",
        "questionId": "A4a",
        "action": "split",
        "filterExpression": "",
        "baseText": "Show each A4a therapy row only for respondents who reported > 0 NEXT‑100 prescriptions for that therapy in A4",
        "splits": [],
        "alternatives": [
          {
            "expression": "A4r2c2 > 0",
            "confidence": 0.8,
            "reason": "Candidate mapping for the Leqvio row in A4a: datamap shows A4ar1* rows are for Leqvio (A4ar1c1/A4ar1c2) and A4r2c2 is the NEXT 100 count for Leqvio. So show A4ar1 rows when A4r2c2 > 0."
          },
          {
            "expression": "A4r3c2 > 0",
            "confidence": 0.8,
            "reason": "Candidate mapping for the Praluent row: A4ar2* appear to be Praluent rows and A4r3c2 is the NEXT 100 count for Praluent."
          },
          {
            "expression": "A4r4c2 > 0",
            "confidence": 0.8,
            "reason": "Candidate mapping for the Repatha row: A4ar3* appear to be Repatha rows and A4r4c2 is the NEXT 100 count for Repatha."
          },
          {
            "expression": "A4r5c2 > 0",
            "confidence": 0.8,
            "reason": "Candidate mapping for the Zetia row: A4ar4* appear to be Zetia rows and A4r5c2 is the NEXT 100 count for Zetia."
          },
          {
            "expression": "A4r6c2 > 0",
            "confidence": 0.8,
            "reason": "Candidate mapping for the Nexletol row: A4ar5* appear to be Nexletol rows and A4r6c2 is the NEXT 100 count for Nexletol."
          },
          {
            "expression": "Alternative: use >= 1 instead of > 0 (e.g., A4r2c2 >= 1)",
            "confidence": 0.6,
            "reason": "If A4 counts are integer then >= 1 is equivalent to > 0; included as a plausible alternative."
          }
        ],
        "confidence": 0.45,
        "reasoning": "This is a row-level rule mapping A4a rows to the corresponding A4 NEXT‑100 counts. The datamap contains A4r#c2 variables (A4r1c2..A4r7c2) which are clearly the NEXT‑100 counts, and it contains A4ar#c# variables (A4ar1c1..A4ar5c2) that appear to be the A4a percentage rows. However the A4ar* series in the datamap only covers five row indices (A4ar1..A4ar5), while A4r#c2 has seven rows (r1..r7). Because I cannot confidently map every expected A4a row (e.g., 'Statin only' and 'Other' rows appear to be missing or named differently in the datamap), I am NOT returning partial split definitions. Below I list the plausible per-row mappings (examples given in Alternatives) that an implementer could use if they confirm the datamap mapping: \n- Leqvio (A4a row vars: A4ar1c1,A4ar1c2) -> A4r2c2 > 0\n- Praluent (A4ar2c1,A4ar2c2) -> A4r3c2 > 0\n- Repatha (A4ar3c1,A4ar3c2) -> A4r4c2 > 0\n- Zetia (A4ar4c1,A4ar4c2) -> A4r5c2 > 0\n- Nexletol (A4ar5c1,A4ar5c2) -> A4r6c2 > 0\nIf A4a also contains 'Statin only' and 'Other' rows, those would likely map to A4r1c2 and A4r7c2 respectively, but corresponding A4ar variables for those rows were not found in the datamap snippet. Because I cannot confidently map ALL A4a rows, I leave splits empty and request human review before implementing row-level splits to avoid accidentally dropping rows.",
        "humanReviewRequired": true
      },
      {
        "ruleId": "rule_a4b_show_rows_where_a4a_colb_gt_0",
        "questionId": "A4b",
        "action": "split",
        "filterExpression": "",
        "baseText": "Show each A4b therapy row only if the corresponding A4a “Without a statin” percentage (column B) for that therapy is > 0.",
        "splits": [
          {
            "rowVariables": [
              "A4br1c1",
              "A4br1c2"
            ],
            "filterExpression": "A4ar1c2 > 0",
            "baseText": "Respondents who indicated > 0% 'Without a statin' for Leqvio in A4a",
            "splitLabel": "Leqvio (inclisiran)"
          },
          {
            "rowVariables": [
              "A4br2c1",
              "A4br2c2"
            ],
            "filterExpression": "A4ar2c2 > 0",
            "baseText": "Respondents who indicated > 0% 'Without a statin' for Praluent in A4a",
            "splitLabel": "Praluent (alirocumab)"
          },
          {
            "rowVariables": [
              "A4br3c1",
              "A4br3c2"
            ],
            "filterExpression": "A4ar3c2 > 0",
            "baseText": "Respondents who indicated > 0% 'Without a statin' for Repatha in A4a",
            "splitLabel": "Repatha (evolocumab)"
          },
          {
            "rowVariables": [
              "A4br4c1",
              "A4br4c2"
            ],
            "filterExpression": "A4ar4c2 > 0",
            "baseText": "Respondents who indicated > 0% 'Without a statin' for Zetia in A4a",
            "splitLabel": "Zetia (ezetimibe)"
          },
          {
            "rowVariables": [
              "A4br5c1",
              "A4br5c2"
            ],
            "filterExpression": "A4ar5c2 > 0",
            "baseText": "Respondents who indicated > 0% 'Without a statin' for Nexletol in A4a",
            "splitLabel": "Nexletol (bempedoic acid)"
          }
        ],
        "alternatives": [
          {
            "expression": "A4ar1c2 >= 1 & A4ar2c2 >= 1 & A4ar3c2 >= 1 & A4ar4c2 >= 1 & A4ar5c2 >= 1",
            "confidence": 0.75,
            "reason": "Alternative: use >= 1 instead of > 0 (equivalent for integer percentage variables). This is less minimal when applied globally but equivalent per-row."
          },
          {
            "expression": "A4ar1c2 > 0",
            "confidence": 0.6,
            "reason": "Per-row alternative shown above; listed here to show that each split could alternatively use >=1. Use per-split variants if preferred."
          }
        ],
        "confidence": 0.9,
        "reasoning": "Datamap contains A4ar#c2 variables (A4ar1c2..A4ar5c2) which are the 'Without a statin' percentage columns for the therapies, and A4br#c# variables (A4br1c1..A4br5c2) which correspond to the A4b rows. The rule maps each A4b therapy row to its matching A4a (column B) variable and shows the row only when that A4ar#c2 > 0. Using > 0 is minimal and appropriate for percentage fields. All referenced variables exist in the datamap.",
        "humanReviewRequired": false
      },
      {
        "ruleId": "rule_a5_if_a4_differs_from_a3_for_pcsk9_rows",
        "questionId": "A5",
        "action": "filter",
        "filterExpression": "(A4r2c2 != A3r2) | (A4r3c2 != A3r3) | (A4r4c2 != A3r4)",
        "baseText": "Respondents whose prescribing in A4 differs from A3 for at least one PCSK9 therapy (Leqvio, Praluent, or Repatha).",
        "splits": [],
        "alternatives": [
          {
            "expression": "(A4r2c1 != A3r2) | (A4r3c1 != A3r3) | (A4r4c1 != A3r4)",
            "confidence": 0.6,
            "reason": "If the intended A4 column to compare to A3 is the c1 column (A4r?c1) rather than c2. A4 has two columns (c1 = 'LAST 100' style text, c2 = 'NEXT 100'); the rule text did not specify which to use."
          },
          {
            "expression": "( (A4r2c2 != A3r2) | (A4r3c2 != A3r3) | (A4r4c2 != A3r4) ) | ( (A4r2c1 != A3r2) | (A4r3c1 != A3r3) | (A4r4c1 != A3r4) )",
            "confidence": 0.45,
            "reason": "Broader interpretation: consider A4 differing from A3 in either A4 column (c1 OR c2). This is more inclusive and may materially change the base; use only if intended by study logic."
          },
          {
            "expression": "( (!is.na(A4r2c2) & !is.na(A3r2) & A4r2c2 != A3r2) | (!is.na(A4r3c2) & !is.na(A3r3) & A4r3c2 != A3r3) | (!is.na(A4r4c2) & !is.na(A3r4) & A4r4c2 != A3r4) )",
            "confidence": 0.55,
            "reason": "Same as primary but explicitly ensures comparisons only when both A3 and A4 values exist for a given therapy. Use to avoid NA-driven ambiguous logical results; stricter in that missing comparisons won't qualify respondents."
          }
        ],
        "confidence": 0.8,
        "reasoning": "Datamap contains A3 row variables for the therapies: A3r2 (Leqvio), A3r3 (Praluent), A3r4 (Repatha). A4 has matching row variables with column suffixes c1 and c2 (A4r2c1/A4r2c2 etc.). The rule asks to show A5 when A4 differs from A3 for any of these three therapies. The primary translation assumes the comparison is between A4's c2 column (A4r?c2, likely the 'NEXT 100' column) and A3's row values, yielding (A4r2c2 != A3r2) | (A4r3c2 != A3r3) | (A4r4c2 != A3r4). There is ambiguity about which A4 column to use (c1 vs c2) and whether missing A3/A4 should be treated as disqualifying; alternatives are provided.",
        "humanReviewRequired": true
      }
    ]
  },
  "metadata": {
    "filtersTranslated": 9,
    "highConfidenceCount": 8,
    "reviewRequiredCount": 2,
    "durationMs": 105272
  },
  "processingInfo": {
    "timestamp": "2026-02-08T06:25:15.292Z",
    "aiProvider": "azure-openai",
    "model": "azure/gpt-5-mini",
    "reasoningEffort": "medium"
  }
}